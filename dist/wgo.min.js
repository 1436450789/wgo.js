/*! WGo.js library, MIT license, wgo.waltheri.net */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("./src/WGo");d.Board=a("./src/Board"),d.Position=a("./src/Position"),d.Game=a("./src/Game"),window.WGo=b.exports=d},{"./src/Board":2,"./src/Game":3,"./src/Position":4,"./src/WGo":5}],2:[function(a,b,c){var d=a("./WGo"),e=function(a,b){var b=b||{};for(var c in b)this[c]=b[c];for(var c in e["default"])void 0===this[c]&&(this[c]=e["default"][c]);for(var c in e.themes["default"])void 0===this.theme[c]&&(this.theme[c]=e.themes["default"][c]);this.tx=this.section.left,this.ty=this.section.top,this.bx=this.size-1-this.section.right,this.by=this.size-1-this.section.bottom,this.init(),a.appendChild(this.element),this.pixelRatio=window.devicePixelRatio||1,this.width&&this.height?this.setDimensions(this.width,this.height):this.width?this.setWidth(this.width):this.height&&this.setHeight(this.height)};e.themes={},e.themes.old={shadowColor:"rgba(32,32,32,0.5)",shadowTransparentColor:"rgba(32,32,32,0)",shadowBlur:0,shadowSize:function(a){return a.shadowSize},markupBlackColor:"rgba(255,255,255,0.8)",markupWhiteColor:"rgba(0,0,0,0.8)",markupNoneColor:"rgba(0,0,0,0.8)",markupLinesWidth:function(a){return a.autoLineWidth?a.stoneRadius/7:a.lineWidth},gridLinesWidth:1,gridLinesColor:function(a){return"rgba(0,0,0,"+Math.min(1,a.stoneRadius/15)+")"},starColor:"#000",starSize:function(a){return a.starSize*(a.width/300+1)},stoneSize:function(a){return a.stoneSize*Math.min(a.fieldWidth,a.fieldHeight)/2},coordinatesColor:"rgba(0,0,0,0.7)",font:function(a){return a.font},linesShift:.5},e.themes["default"]={shadowColor:"rgba(62,32,32,0.5)",shadowTransparentColor:"rgba(62,32,32,0)",shadowBlur:function(a){return.1*a.stoneRadius},shadowSize:1,markupBlackColor:"rgba(255,255,255,0.9)",markupWhiteColor:"rgba(0,0,0,0.7)",markupNoneColor:"rgba(0,0,0,0.7)",markupLinesWidth:function(a){return a.stoneRadius/8},gridLinesWidth:function(a){return a.stoneRadius/15},gridLinesColor:"#654525",starColor:"#531",starSize:function(a){return a.stoneRadius/8+1},stoneSize:function(a){return Math.min(a.fieldWidth,a.fieldHeight)/2},coordinatesColor:"#531",variationColor:"rgba(0,32,128,0.8)",font:"calibri",linesShift:.25};var f,g=function(a,b){return"function"==typeof b.theme[a]?b.theme[a](b):b.theme[a]},h={draw:function(a,b){var c=b.getX(a.x),d=b.getY(a.y),e=b.stoneRadius;this.beginPath();var f=g("shadowBlur",b),h=Math.max(0,e-.5),i=this.createRadialGradient(c-b.ls,d-b.ls,h-1-f,c-b.ls,d-b.ls,h+f);i.addColorStop(0,g("shadowColor",b)),i.addColorStop(1,g("shadowTransparentColor",b)),this.fillStyle=i,this.arc(c-b.ls,d-b.ls,h+f,0,2*Math.PI,!0),this.fill()},clear:function(a,b){var c=b.getX(a.x),d=b.getY(a.y),e=b.stoneRadius;this.clearRect(c-1.1*e-b.ls,d-1.1*e-b.ls,2.2*e,2.2*e)}},i=function(a,b,c){return a.obj_arr[b][c][0].c==d.B?g("markupBlackColor",a):a.obj_arr[b][c][0].c==d.W?g("markupWhiteColor",a):g("markupNoneColor",a)},j=function(a,b,c){return a.obj_arr[b][c][0]&&a.obj_arr[b][c][0].c==d.W||a.obj_arr[b][c][0].c==d.B},k=function(a,b){var c;a[b].clear(),a[b].draw(a);for(var d=0;d<a.size;d++)for(var f=0;f<a.size;f++)for(var g=0;g<a.obj_arr[d][f].length;g++){var h=a.obj_arr[d][f][g];c=h.type?"string"==typeof h.type?e.drawHandlers[h.type]:h.type:a.stoneHandler,c[b]&&c[b].draw.call(a[b].getContext(h),h,a)}for(var i=0;i<a.obj_list.length;i++){var h=a.obj_list[i],c=h.handler;c[b]&&c[b].draw.call(a[b].getContext(h.args),h.args,a)}},l=function(a,b,c,d,e,f,g,h){a.strokeStyle="rgba(64,64,64,0.2)",a.lineWidth=d/30*h,a.beginPath(),d-=Math.max(1,a.lineWidth);var i,j,b,k,l,m=b+d*Math.cos(e*Math.PI),n=c+d*Math.sin(e*Math.PI),o=b+d*Math.cos(f*Math.PI),p=c+d*Math.sin(f*Math.PI);o>m?(i=(p-n)/(o-m),j=Math.atan(i)):o==m?j=Math.PI/2:(i=(p-n)/(o-m),j=Math.atan(i)-Math.PI);var q=g*d;k=Math.sin(j)*q,l=Math.cos(j)*q;var r=m+k,s=n-l,t=o+k,u=p-l;a.moveTo(m,n),a.bezierCurveTo(r,s,t,u,o,p),a.stroke()},m=function(a){for(var b=a.angle,c=a.angle,d=0;d<a.lines.length;d++)b+=a.lines[d],c-=a.lines[d],l(a.ctx,a.x,a.y,a.radius,b,c,a.factor,a.thickness)};e.drawHandlers={NORMAL:{stone:{draw:function(a,b){var c,e=b.getX(a.x),f=b.getY(a.y),g=b.stoneRadius;a.c==d.W?(c=this.createRadialGradient(e-2*g/5,f-2*g/5,g/3,e-g/5,f-g/5,5*g/5),c.addColorStop(0,"#fff"),c.addColorStop(1,"#aaa")):(c=this.createRadialGradient(e-2*g/5,f-2*g/5,1,e-g/5,f-g/5,4*g/5),c.addColorStop(0,"#666"),c.addColorStop(1,"#000")),this.beginPath(),this.fillStyle=c,this.arc(e-b.ls,f-b.ls,Math.max(0,g-.5),0,2*Math.PI,!0),this.fill()}},shadow:h},PAINTED:{stone:{draw:function(a,b){var c,e=b.getX(a.x),f=b.getY(a.y),g=b.stoneRadius;a.c==d.W?(c=this.createRadialGradient(e-2*g/5,f-2*g/5,2,e-g/5,f-g/5,4*g/5),c.addColorStop(0,"#fff"),c.addColorStop(1,"#ddd")):(c=this.createRadialGradient(e-2*g/5,f-2*g/5,1,e-g/5,f-g/5,4*g/5),c.addColorStop(0,"#111"),c.addColorStop(1,"#000")),this.beginPath(),this.fillStyle=c,this.arc(e-b.ls,f-b.ls,Math.max(0,g-.5),0,2*Math.PI,!0),this.fill(),this.beginPath(),this.lineWidth=g/6,a.c==d.W?(this.strokeStyle="#999",this.arc(e+g/8,f+g/8,g/2,0,Math.PI/2,!1)):(this.strokeStyle="#ccc",this.arc(e-g/8,f-g/8,g/2,Math.PI,1.5*Math.PI)),this.stroke()}},shadow:h},GLOW:{stone:{draw:function(a,b){var c,e=b.getX(a.x),f=b.getY(a.y),g=b.stoneRadius;a.c==d.W?(c=this.createRadialGradient(e-2*g/5,f-2*g/5,g/3,e-g/5,f-g/5,8*g/5),c.addColorStop(0,"#fff"),c.addColorStop(1,"#666")):(c=this.createRadialGradient(e-2*g/5,f-2*g/5,1,e-g/5,f-g/5,3*g/5),c.addColorStop(0,"#555"),c.addColorStop(1,"#000")),this.beginPath(),this.fillStyle=c,this.arc(e-b.ls,f-b.ls,Math.max(0,g-.5),0,2*Math.PI,!0),this.fill()}},shadow:h},SHELL:{stone:{draw:function(a,b){var c,e,g=b.stoneRadius;f=f||Math.ceil(9999999*Math.random()),c=b.getX(a.x),e=b.getY(a.y);var h;if(h=a.c==d.W?"#aaa":"#000",this.beginPath(),this.fillStyle=h,this.arc(c-b.ls,e-b.ls,Math.max(0,g-.5),0,2*Math.PI,!0),this.fill(),a.c==d.W){var i=f%(3+a.x*b.size+a.y)%3,j=b.size*b.size+a.x*b.size+a.y,k=2/j*(f%j);m(0==i?{ctx:this,x:c,y:e,radius:g,angle:k,lines:[.1,.12,.11,.1,.09,.09,.09,.09],factor:.25,thickness:1.75}:1==i?{ctx:this,x:c,y:e,radius:g,angle:k,lines:[.1,.09,.08,.07,.06,.06,.06,.06,.06,.06,.06],factor:.2,thickness:1.5}:{ctx:this,x:c,y:e,radius:g,angle:k,lines:[.12,.14,.13,.12,.12,.12],factor:.3,thickness:2}),h=this.createRadialGradient(c-2*g/5,e-2*g/5,g/3,c-g/5,e-g/5,5*g/5),h.addColorStop(0,"rgba(255,255,255,0.9)"),h.addColorStop(1,"rgba(255,255,255,0)"),this.beginPath(),this.fillStyle=h,this.arc(c-b.ls,e-b.ls,Math.max(0,g-.5),0,2*Math.PI,!0),this.fill()}else h=this.createRadialGradient(c+.4*g,e+.4*g,0,c+.5*g,e+.5*g,g),h.addColorStop(0,"rgba(32,32,32,1)"),h.addColorStop(1,"rgba(0,0,0,0)"),this.beginPath(),this.fillStyle=h,this.arc(c-b.ls,e-b.ls,Math.max(0,g-.5),0,2*Math.PI,!0),this.fill(),h=this.createRadialGradient(c-.4*g,e-.4*g,1,c-.5*g,e-.5*g,1.5*g),h.addColorStop(0,"rgba(64,64,64,1)"),h.addColorStop(1,"rgba(0,0,0,0)"),this.beginPath(),this.fillStyle=h,this.arc(c-b.ls,e-b.ls,Math.max(0,g-.5),0,2*Math.PI,!0),this.fill()}},shadow:h},MONO:{stone:{draw:function(a,b){var c=b.getX(a.x),e=b.getY(a.y),f=b.stoneRadius,h=g("markupLinesWidth",b)||1;a.c==d.W?this.fillStyle="white":this.fillStyle="black",this.beginPath(),this.arc(c,e,Math.max(0,f-h),0,2*Math.PI,!0),this.fill(),this.lineWidth=h,this.strokeStyle="black",this.stroke()}}},CR:{stone:{draw:function(a,b){var c=b.getX(a.x),d=b.getY(a.y),e=b.stoneRadius;this.strokeStyle=a.c||i(b,a.x,a.y),this.lineWidth=a.lineWidth||g("markupLinesWidth",b)||1,this.beginPath(),this.arc(c-b.ls,d-b.ls,e/2,0,2*Math.PI,!0),this.stroke()}}},LB:{stone:{draw:function(a,b){var c=b.getX(a.x),d=b.getY(a.y),e=b.stoneRadius,f=a.font||g("font",b)||"";this.fillStyle=a.c||i(b,a.x,a.y),1==a.text.length?this.font=Math.round(1.5*e)+"px "+f:2==a.text.length?this.font=Math.round(1.2*e)+"px "+f:this.font=Math.round(e)+"px "+f,this.beginPath(),this.textBaseline="middle",this.textAlign="center",this.fillText(a.text,c,d,2*e)}},grid:{draw:function(a,b){if(!j(b,a.x,a.y)&&!a._nodraw){var c=b.getX(a.x),d=b.getY(a.y),e=b.stoneRadius;this.clearRect(c-e,d-e,2*e,2*e)}},clear:function(a,b){j(b,a.x,a.y)||(a._nodraw=!0,k(b,"grid"),delete a._nodraw)}}},SQ:{stone:{draw:function(a,b){var c=b.getX(a.x),d=b.getY(a.y),e=Math.round(b.stoneRadius);this.strokeStyle=a.c||i(b,a.x,a.y),this.lineWidth=a.lineWidth||g("markupLinesWidth",b)||1,this.beginPath(),this.rect(Math.round(c-e/2)-b.ls,Math.round(d-e/2)-b.ls,e,e),this.stroke()}}},TR:{stone:{draw:function(a,b){var c=b.getX(a.x),d=b.getY(a.y),e=b.stoneRadius;this.strokeStyle=a.c||i(b,a.x,a.y),this.lineWidth=a.lineWidth||g("markupLinesWidth",b)||1,this.beginPath(),this.moveTo(c-b.ls,d-b.ls-Math.round(e/2)),this.lineTo(Math.round(c-e/2)-b.ls,Math.round(d+e/3)+b.ls),this.lineTo(Math.round(c+e/2)+b.ls,Math.round(d+e/3)+b.ls),this.closePath(),this.stroke()}}},MA:{stone:{draw:function(a,b){var c=b.getX(a.x),d=b.getY(a.y),e=b.stoneRadius;this.strokeStyle=a.c||i(b,a.x,a.y),this.lineCap="round",this.lineWidth=2*(a.lineWidth||g("markupLinesWidth",b)||1)-1,this.beginPath(),this.moveTo(Math.round(c-e/2),Math.round(d-e/2)),this.lineTo(Math.round(c+e/2),Math.round(d+e/2)),this.moveTo(Math.round(c+e/2)-1,Math.round(d-e/2)),this.lineTo(Math.round(c-e/2)-1,Math.round(d+e/2)),this.stroke(),this.lineCap="butt"}}},SL:{stone:{draw:function(a,b){var c=b.getX(a.x),d=b.getY(a.y),e=b.stoneRadius;this.fillStyle=a.c||i(b,a.x,a.y),this.beginPath(),this.rect(c-e/2,d-e/2,e,e),this.fill()}}},SM:{stone:{draw:function(a,b){var c=b.getX(a.x),d=b.getY(a.y),e=b.stoneRadius;this.strokeStyle=a.c||i(b,a.x,a.y),this.lineWidth=2*(a.lineWidth||g("markupLinesWidth",b)||1),this.beginPath(),this.arc(c-e/3,d-e/3,e/6,0,2*Math.PI,!0),this.stroke(),this.beginPath(),this.arc(c+e/3,d-e/3,e/6,0,2*Math.PI,!0),this.stroke(),this.beginPath(),this.moveTo(c-e/1.5,d),this.bezierCurveTo(c-e/1.5,d+e/2,c+e/1.5,d+e/2,c+e/1.5,d),this.stroke()}}},outline:{stone:{draw:function(a,b){a.alpha?this.globalAlpha=a.alpha:this.globalAlpha=.3,a.stoneStyle?e.drawHandlers[a.stoneStyle].stone.draw.call(this,a,b):b.stoneHandler.stone.draw.call(this,a,b),this.globalAlpha=1}}},mini:{stone:{draw:function(a,b){b.stoneRadius=b.stoneRadius/2,a.stoneStyle?e.drawHandlers[a.stoneStyle].stone.draw.call(this,a,b):b.stoneHandler.stone.draw.call(this,a,b),b.stoneRadius=2*b.stoneRadius}}}},e.coordinates={grid:{draw:function(a,b){var c,d,e,f,h,i;this.fillStyle=g("coordinatesColor",b),this.textBaseline="middle",this.textAlign="center",this.font=b.stoneRadius+"px "+(b.font||""),e=b.getX(-.75),f=b.getX(b.size-.25),h=b.getY(-.75),i=b.getY(b.size-.25);for(var j=0;j<b.size;j++)c=j+"A".charCodeAt(0),c>="I".charCodeAt(0)&&c++,d=b.getY(j),this.fillText(b.size-j,e,d),this.fillText(b.size-j,f,d),d=b.getX(j),this.fillText(String.fromCharCode(c),d,h),this.fillText(String.fromCharCode(c),d,i);this.fillStyle="black"}}},e.CanvasLayer=function(){this.element=document.createElement("canvas"),this.context=this.element.getContext("2d"),this.pixelRatio=window.devicePixelRatio||1,this.pixelRatio>1&&this.context.scale(this.pixelRatio,this.pixelRatio)},e.CanvasLayer.prototype={constructor:e.CanvasLayer,setDimensions:function(a,b){this.element.width=a,this.element.style.width=a/this.pixelRatio+"px",this.element.height=b,this.element.style.height=b/this.pixelRatio+"px"},appendTo:function(a,b){this.element.style.position="absolute",this.element.style.zIndex=b,a.appendChild(this.element)},removeFrom:function(a){a.removeChild(this.element)},getContext:function(){return this.context},draw:function(a){},clear:function(){this.context.clearRect(0,0,this.element.width,this.element.height)}},e.GridLayer=d.extendClass(e.CanvasLayer,function(){this["super"].call(this)}),e.GridLayer.prototype.draw=function(a){var b;this.context.beginPath(),this.context.lineWidth=g("gridLinesWidth",a),this.context.strokeStyle=g("gridLinesColor",a);var c=Math.round(a.left),d=Math.round(a.top),e=Math.round(a.fieldWidth*(a.size-1)),f=Math.round(a.fieldHeight*(a.size-1));this.context.strokeRect(c-a.ls,d-a.ls,e,f);for(var h=1;h<a.size-1;h++)b=Math.round(a.getX(h))-a.ls,this.context.moveTo(b,d),this.context.lineTo(b,d+f),b=Math.round(a.getY(h))-a.ls,this.context.moveTo(c,b),this.context.lineTo(c+e,b);if(this.context.stroke(),this.context.fillStyle=g("starColor",a),a.starPoints[a.size])for(var i in a.starPoints[a.size])this.context.beginPath(),this.context.arc(a.getX(a.starPoints[a.size][i].x)-a.ls,a.getY(a.starPoints[a.size][i].y)-a.ls,g("starSize",a),0,2*Math.PI,!0),this.context.fill()},e.MultipleCanvasLayer=d.extendClass(e.CanvasLayer,function(){this.init(4)}),e.MultipleCanvasLayer.prototype.init=function(a){var b,c;this.layers=a,this.elements=[],this.contexts=[],this.pixelRatio=window.devicePixelRatio||1;for(var d=0;a>d;d++)b=document.createElement("canvas"),c=b.getContext("2d"),this.pixelRatio>1&&c.scale(this.pixelRatio,this.pixelRatio),this.elements.push(b),this.contexts.push(c)},e.MultipleCanvasLayer.prototype.appendTo=function(a,b){for(var c=0;c<this.layers;c++)this.elements[c].style.position="absolute",this.elements[c].style.zIndex=b,a.appendChild(this.elements[c])},e.MultipleCanvasLayer.prototype.removeFrom=function(a){for(var b=0;b<this.layers;b++)a.removeChild(this.elements[b])},e.MultipleCanvasLayer.prototype.getContext=function(a){return a.x%2?a.y%2?this.contexts[0]:this.contexts[1]:a.y%2?this.contexts[2]:this.contexts[3]},e.MultipleCanvasLayer.prototype.clear=function(a,b){for(var c=0;c<this.layers;c++)this.contexts[c].clearRect(0,0,this.elements[c].width,this.elements[c].height)},e.MultipleCanvasLayer.prototype.setDimensions=function(a,b){for(var c=0;c<this.layers;c++)this.elements[c].width=a,this.elements[c].style.width=a/this.pixelRatio+"px",this.elements[c].height=b,this.elements[c].style.height=b/this.pixelRatio+"px"},e.ShadowLayer=d.extendClass(e.MultipleCanvasLayer,function(a,b,c){this.init(2),this.shadowSize=void 0===b?1:b,this.board=a}),e.ShadowLayer.prototype.getContext=function(a){return!(a.x%2&&a.y%2)&&(a.x%2||a.y%2)?this.contexts[1]:this.contexts[0]},e.ShadowLayer.prototype.setDimensions=function(a,b){this["super"].prototype.setDimensions.call(this,a,b);for(var c=0;c<this.layers;c++)this.contexts[c].setTransform(1,0,0,1,Math.round(this.shadowSize*this.board.stoneRadius/7),Math.round(this.shadowSize*this.board.stoneRadius/7))};var n=function(a,b){var c=b.getX(a.x),d=b.getY(a.y),e=b.stoneRadius;this.clearRect(c-2*e-b.ls,d-2*e-b.ls,4*e,4*e)},o=function(){return 3*this.width/(4*(this.bx+1-this.tx)+2)-this.fieldWidth*this.tx},p=function(){return 3*this.height/(4*(this.by+1-this.ty)+2)-this.fieldHeight*this.ty},q=function(){return 4*this.width/(4*(this.bx+1-this.tx)+2)},r=function(){return 4*this.height/(4*(this.by+1-this.ty)+2)},s=function(a,b){for(var c,d=0;d<this.obj_arr[a][b].length;d++){var f=this.obj_arr[a][b][d];c=f.type?"string"==typeof f.type?e.drawHandlers[f.type]:f.type:this.stoneHandler;for(var g in c)c[g].clear?c[g].clear.call(this[g].getContext(f),f,this):n.call(this[g].getContext(f),f,this)}},t=function(a,b){for(var c,d=0;d<this.obj_arr[a][b].length;d++){var f=this.obj_arr[a][b][d];c=f.type?"string"==typeof f.type?e.drawHandlers[f.type]:f.type:this.stoneHandler;for(var g in c)c[g].draw.call(this[g].getContext(f),f,this)}},u=function(a){var b,c;return b=a.layerX*this.pixelRatio,b-=this.left,b/=this.fieldWidth,b=Math.round(b),c=a.layerY*this.pixelRatio,c-=this.top,c/=this.fieldHeight,c=Math.round(c),{x:b>=this.size?-1:b,y:c>=this.size?-1:c}},v=function(){this.element.style.width=this.width/this.pixelRatio+"px",this.element.style.height=this.height/this.pixelRatio+"px",this.stoneRadius=g("stoneSize",this),this.ls=g("linesShift",this);for(var a=0;a<this.layers.length;a++)this.layers[a].setDimensions(this.width,this.height)};e.prototype={constructor:e,init:function(){this.obj_arr=[];for(var a=0;a<this.size;a++){this.obj_arr[a]=[];for(var b=0;b<this.size;b++)this.obj_arr[a][b]=[]}this.obj_list=[],this.layers=[],this.listeners=[],this.element=document.createElement("div"),this.element.className="wgo-board",this.element.style.position="relative",this.background&&("#"==this.background[0]?this.element.style.backgroundColor=this.background:this.element.style.backgroundImage="url('"+this.background+"')"),this.grid=new e.GridLayer,this.shadow=new e.ShadowLayer(this,g("shadowSize",this)),this.stone=new e.MultipleCanvasLayer,this.addLayer(this.grid,100),this.addLayer(this.shadow,200),this.addLayer(this.stone,300)},setWidth:function(a){this.width=a,this.width*=this.pixelRatio,this.fieldHeight=this.fieldWidth=q.call(this),this.left=o.call(this),this.height=(this.by-this.ty+1.5)*this.fieldHeight,this.top=p.call(this),v.call(this),this.redraw()},setHeight:function(a){this.height=a,this.height*=this.pixelRatio,this.fieldWidth=this.fieldHeight=r.call(this),this.top=p.call(this),this.width=(this.bx-this.tx+1.5)*this.fieldWidth,this.left=o.call(this),v.call(this),this.redraw()},setDimensions:function(a,b){this.width=a||parseInt(this.element.style.width,10),this.width*=this.pixelRatio,this.height=b||parseInt(this.element.style.height,10),this.height*=this.pixelRatio,this.fieldWidth=q.call(this),this.fieldHeight=r.call(this),this.left=o.call(this),this.top=p.call(this),v.call(this),this.redraw()},getSection:function(){return this.section},setSection:function(a,b,c,d){"object"==typeof a?this.section=a:this.section={top:a,right:b,bottom:c,left:d},this.tx=this.section.left,this.ty=this.section.top,this.bx=this.size-1-this.section.right,this.by=this.size-1-this.section.bottom,this.setDimensions()},setSize:function(a){var a=a||19;if(a!=this.size){this.size=a,this.obj_arr=[];for(var b=0;b<this.size;b++){this.obj_arr[b]=[];for(var c=0;c<this.size;c++)this.obj_arr[b][c]=[]}this.bx=this.size-1-this.section.right,this.by=this.size-1-this.section.bottom,this.setDimensions()}},redraw:function(){try{for(var a=0;a<this.layers.length;a++)this.layers[a].clear(this),this.layers[a].draw(this);for(var a=0;a<this.size;a++)for(var b=0;b<this.size;b++)t.call(this,a,b);for(var a=0;a<this.obj_list.length;a++){var c=this.obj_list[a],d=c.handler;for(var e in d)d[e].draw.call(this[e].getContext(c.args),c.args,this)}}catch(f){console.log("WGo board failed to render. Error: "+f.message)}},getX:function(a){return this.left+a*this.fieldWidth},getY:function(a){return this.top+a*this.fieldHeight},addLayer:function(a,b){a.appendTo(this.element,b),a.setDimensions(this.width,this.height),this.layers.push(a)},removeLayer:function(a){var b=this.layers.indexOf(a);b>=0&&(this.layers.splice(b,1),a.removeFrom(this.element))},update:function(a){var b;if(a.remove&&"all"==a.remove)this.removeAllObjects();else if(a.remove)for(b=0;b<a.remove.length;b++)this.removeObject(a.remove[b]);if(a.add)for(b=0;b<a.add.length;b++)this.addObject(a.add[b])},addObject:function(a){if(a.constructor!=Array)try{s.call(this,a.x,a.y);for(var b=this.obj_arr[a.x][a.y],c=0;c<b.length;c++)if(b[c].type==a.type)return b[c]=a,void t.call(this,a.x,a.y);a.type?b.push(a):b.unshift(a),t.call(this,a.x,a.y)}catch(d){console.log("WGo board failed to render. Error: "+d.message)}else for(var e=0;e<a.length;e++)this.addObject(a[e])},removeObject:function(a){if(a.constructor!=Array)try{for(var b,c=0;c<this.obj_arr[a.x][a.y].length;c++)if(this.obj_arr[a.x][a.y][c].type==a.type){b=c;break}if(void 0===b)return;s.call(this,a.x,a.y),this.obj_arr[a.x][a.y].splice(b,1),t.call(this,a.x,a.y)}catch(d){console.log("WGo board failed to render. Error: "+d.message)}else for(var e=0;e<a.length;e++)this.removeObject(a[e])},removeObjectsAt:function(a,b){this.obj_arr[a][b].length&&(s.call(this,a,b),this.obj_arr[a][b]=[])},removeAllObjects:function(){this.obj_arr=[];for(var a=0;a<this.size;a++){this.obj_arr[a]=[];for(var b=0;b<this.size;b++)this.obj_arr[a][b]=[]}this.redraw()},addCustomObject:function(a,b){this.obj_list.push({handler:a,args:b}),this.redraw()},removeCustomObject:function(a,b){for(var c=0;c<this.obj_list.length;c++){var d=this.obj_list[c];if(d.handler==a&&d.args==b)return this.obj_list.splice(c,1),this.redraw(),!0}return!1},addEventListener:function(a,b){var c=this,d={type:a,callback:b,handleEvent:function(a){var d=u.call(c,a);b(d.x,d.y,a)}};this.element.addEventListener(a,d,!0),this.listeners.push(d)},removeEventListener:function(a,b){for(var c=0;c<this.listeners.length;c++){var d=this.listeners[c];if(d.type==a&&d.callback==b)return this.element.removeEventListener(d.type,d,!0),this.listeners.splice(c,1),!0}return!1},getState:function(){return{objects:d.clone(this.obj_arr),custom:d.clone(this.obj_list)}},restoreState:function(a){this.obj_arr=a.objects||this.obj_arr,this.obj_list=a.custom||this.obj_list,this.redraw()}},e["default"]={size:19,width:0,height:0,font:"Calibri",lineWidth:1,autoLineWidth:!1,starPoints:{19:[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}],13:[{x:3,y:3},{x:9,y:3},{x:3,y:9},{x:9,y:9}],9:[{x:4,y:4}]},stoneHandler:e.drawHandlers.SHELL,starSize:1,shadowSize:1,stoneSize:1,section:{top:0,right:0,bottom:0,left:0},background:d.DIR+"wood1.jpg",theme:{}},b.exports=e},{"./WGo":5}],3:[function(a,b,c){var d=a("./WGo"),e=a("./Position"),f=function(a,b,c,f){this.size=a||19,this.repeating=void 0===b?"KO":b,this.allow_rewrite=c||!1,this.allow_suicide=f||!1,this.stack=[],this.stack[0]=new e(this.size),this.stack[0].capCount={black:0,white:0},this.turn=d.B,Object.defineProperty(this,"position",{get:function(){return this.stack[this.stack.length-1]},set:function(a){this.stack[this.stack.length-1]=a}})},g=function(a,b,c,d,e){c>=0&&c<a.size&&d>=0&&d<a.size&&a.get(c,d)==e&&(a.set(c,d,0),b.push({x:c,y:d}),g(a,b,c,d-1,e),g(a,b,c,d+1,e),g(a,b,c-1,d,e),g(a,b,c+1,d,e))},h=function(a,b,c,d,e){return 0>c||c>=a.size||0>d||d>=a.size?!0:0==a.get(c,d)?!1:1==b.get(c,d)||a.get(c,d)==-e?!0:(b.set(c,d,!0),h(a,b,c,d-1,e)&&h(a,b,c,d+1,e)&&h(a,b,c-1,d,e)&&h(a,b,c+1,d,e))},i=function(a,b,c,d){var f=[];if(b>=0&&b<a.size&&c>=0&&c<a.size&&a.get(b,c)==d){var i=new e(a.size);h(a,i,b,c,d)&&g(a,f,b,c,d)}return f},j=function(a,b,c){var d,e;if("KO"==this.repeating&&this.stack.length-2>=0)e=this.stack.length-2;else{if("ALL"!=this.repeating)return!0;e=0}for(var f=this.stack.length-2;f>=e;f--)if(this.stack[f].get(b,c)==a.get(b,c)){d=!0;for(var g=0;g<this.size*this.size;g++)if(this.stack[f].schema[g]!=a.schema[g]){d=!1;break}if(d)return!1}return!0};f.prototype={constructor:f,getPosition:function(){return this.stack[this.stack.length-1]},play:function(a,b,c,f){if(!this.isOnBoard(a,b))return 1;if(!this.allow_rewrite&&0!=this.position.get(a,b))return 2;c||(c=this.turn);var k=this.position.clone();k.set(a,b,c);var l=c,m=i(k,a-1,b,-c).concat(i(k,a+1,b,-c),i(k,a,b-1,-c),i(k,a,b+1,-c));if(!m.length){var n=new e(this.size);if(h(k,n,a,b,c)){if(!this.allow_suicide)return 3;l=-c,g(k,m,a,b,c)}}return this.repeating&&!j.call(this,k,a,b)?4:f?!1:(k.color=c,k.capCount={black:this.position.capCount.black,white:this.position.capCount.white},l==d.B?k.capCount.black+=m.length:k.capCount.white+=m.length,this.pushPosition(k),this.turn=-c,m)},pass:function(a){this.pushPosition(),a?(this.position.color=a,this.turn=-a):(this.position.color=this.turn,this.turn=-this.turn)},isValid:function(a,b,c){return"number"!=typeof this.play(a,b,c,!0)},isOnBoard:function(a,b){return a>=0&&b>=0&&a<this.size&&b<this.size},addStone:function(a,b,c){return this.isOnBoard(a,b)&&0==this.position.get(a,b)?(this.position.set(a,b,c||0),!0):!1},removeStone:function(a,b){return this.isOnBoard(a,b)&&0!=this.position.get(a,b)?(this.position.set(a,b,0),!0):!1},setStone:function(a,b,c){return this.isOnBoard(a,b)?(this.position.set(a,b,c||0),!0):!1},getStone:function(a,b){return this.isOnBoard(a,b)?this.position.get(a,b):0},pushPosition:function(a){if(!a){var a=this.position.clone();a.capCount={black:this.position.capCount.black,white:this.position.capCount.white},a.color=this.position.color}return this.stack.push(a),a.color&&(this.turn=-a.color),this},popPosition:function(){var a=null;return this.stack.length>0&&(a=this.stack.pop(),0==this.stack.length?this.turn=d.B:this.position.color?this.turn=-this.position.color:this.turn=-this.turn),a},firstPosition:function(){return this.stack=[],this.stack[0]=new e(this.size),this.stack[0].capCount={black:0,white:0},this.turn=d.B,this},getCaptureCount:function(a){return a==d.B?this.position.capCount.black:this.position.capCount.white},validatePosition:function(){for(var a,b,c=0,e=0,f=[],g=this.position.clone(),h=0;h<this.size;h++)for(var j=0;j<this.size;j++)a=this.position.get(h,j),a&&(b=f.length,f=f.concat(i(g,h-1,j,-a),i(g,h+1,j,-a),i(g,h,j-1,-a),i(g,h,j+1,-a)),a==d.B?e+=f-b:c+=f-b);return this.position.capCount.black+=e,this.position.capCount.white+=c,this.position.schema=g.schema,f}},b.exports=f},{"./Position":4,"./WGo":5}],4:[function(a,b,c){var d=function(a){this.size=a||19,this.schema=[];for(var b=0;b<this.size*this.size;b++)this.schema[b]=0};d.prototype={constructor:d,get:function(a,b){return 0>a||0>b||a>=this.size||b>=this.size?void 0:this.schema[a*this.size+b]},set:function(a,b,c){return this.schema[a*this.size+b]=c,this},clear:function(){for(var a=0;a<this.size*this.size;a++)this.schema[a]=0;return this},clone:function(){var a=new d(this.size);return a.schema=this.schema.slice(0),a},compare:function(a){for(var b=[],c=[],d=0;d<this.size*this.size;d++)this.schema[d]&&!a.schema[d]?c.push({x:Math.floor(d/this.size),y:d%this.size}):this.schema[d]!=a.schema[d]&&b.push({x:Math.floor(d/this.size),y:d%this.size,c:a.schema[d]});return{add:b,remove:c}}},b.exports=d},{}],5:[function(a,b,c){var d=document.getElementsByTagName("script"),e=d[d.length-1].src.split("?")[0],f=e.split("/").slice(0,-1).join("/")+"/",g={version:"3",B:1,BLACK:1,W:-1,WHITE:-1,ERROR_REPORT:!0,DIR:f,lang:"en",i18n:{en:{}}};g.opera=-1!=navigator.userAgent.search(/(opera)(?:.*version)?[ \/]([\w.]+)/i),g.webkit=-1!=navigator.userAgent.search(/(webkit)[ \/]([\w.]+)/i),g.msie=-1!=navigator.userAgent.search(/(msie) ([\w.]+)/i),g.mozilla=-1!=navigator.userAgent.search(/(mozilla)(?:.*? rv:([\w.]+))?/i)&&!g.webkit&&!g.msie,g.t=function(a){var b=g.i18n[g.lang][a]||g.i18n.en[a];if(b){for(var c=1;c<arguments.length;c++)b=b.replace("$",arguments[c]);return b}return a},g.extendClass=function(a,b){return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype["super"]=a,b},g.abstractMethod=function(){throw Error("unimplemented abstract method")},g.clone=function(a){if(a&&"object"==typeof a){var b=a.constructor==Array?[]:{};for(var c in a)a[c]==a?b[c]=a:b[c]=g.clone(a[c]);return b}return a},g.filterHTML=function(a){return a&&"string"==typeof a?a.replace(/</g,"&lt;").replace(/>/g,"&gt;"):a},b.exports=g},{}]},{},[1]);
//# sourceMappingURL=wgo.min.map